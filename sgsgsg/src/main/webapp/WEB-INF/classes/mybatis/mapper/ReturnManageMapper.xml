<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sgsg.dra.admin.mapper.ReturnManageMapper">

	<!--  -->
	<insert id="insertReturnRequest" parameterType="map">
		INSERT INTO RETURN_REQUEST(RETURN_EXCHANGE_NUM, REQUEST_TYPE, REQUEST_DATE, REFUND_AMOUNT,
			REQUEST_REASON, DETAIL_STATUS, INSPECTION_RESULT, ORDERDETAILNUM)
		VALUES(RETURN_REQUEST_seq.nextval, #{request_type}, #{request_date}, #{refund_amount},
			#{request_reason}, #{detail_status}, ${inspection_result, jdbcType=VARCHAR}, #{orderDetailNum})
	</insert>
	
	<!-- 요청 리스트 -->
	<select id="listReturnRequest" resultType="com.sgsg.dra.domain.Return">
		SELECT rr.RETURN_EXCHANGE_NUM, REQUEST_TYPE, REQUEST_DATE, DETAIL_STATUS, rr.ORDERDETAILNUM, REFUND_AMOUNT,
			REQUEST_REASON, INSPECTION_RESULT, od.ORDERNUM, QTY, ps.STOCKNUM, ps.PRODUCTNUM, PRODUCTNAME, 
			od.PRICE, od.SALEPRICE, od.PRODUCTMONEY, od.SAVEDMONEY, ps.DETAILNUM, ps.DETAILNUM2, p.OPTIONCOUNT,
			d1.OPTIONVALUE, d1.OPTIONNUM, d2.OPTIONVALUE as OPTIONVALUE2, d2.OPTIONNUM as OPTIONNUM2
		FROM RETURN_REQUEST rr
		LEFT OUTER JOIN orderDetail od ON rr.ORDERDETAILNUM = od.ORDERDETAILNUM
		JOIN productStock ps ON od.stockNum = ps.stockNum
		JOIN product p ON ps.productNum = p.productNum
		LEFT OUTER JOIN optionDetail d1 ON ps.detailNum = d1.detailNum
		LEFT OUTER JOIN optionDetail d2 ON ps.detailNum2 = d2.detailNum
	</select>
	<!-- 요청 상세 -->
</mapper>